<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalog Setup - Jewelry Inventory</title>
    <style>
        .transition-200 {
            transition: all 0.2s ease;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .tab-button.active {
            border-bottom: 3px solid #3b82f6;
            color: #3b82f6;
            font-weight: 600;
        }

        .attribute-item {
            transition: all 0.2s ease;
        }

        .attribute-item:hover {
            background-color: #f8fafc;
        }
    </style>
</head>

<body class="bg-gray-50">
    <div>
        <div class="p-6">
            <div class="bg-white rounded-lg shadow-sm mb-6">
                <div class="border-b border-gray-200">
                    <nav class="flex -mb-px">
                        <button id="polishTab"
                            class="tab-button active py-4 px-6 text-center border-b-2 font-medium text-sm">
                            Polish Types
                        </button>
                        <button id="categoryTab"
                            class="tab-button py-4 px-6 text-center border-b-2 font-medium text-sm">
                            Categories
                        </button>
                        <button id="subcategoryTab"
                            class="tab-button py-4 px-6 text-center border-b-2 font-medium text-sm">
                            Sub Categories
                        </button>
                        <button id="attributeTab"
                            class="tab-button py-4 px-6 text-center border-b-2 font-medium text-sm">
                            Attributes
                        </button>
                        <button id="materialTab"
                            class="tab-button py-4 px-6 text-center border-b-2 font-medium text-sm">
                            Materials
                        </button>
                    </nav>
                </div>
            </div>

            <!-- Tab Contents -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <!-- Polish Types Tab Content -->
                <div id="polishContent" class="tab-content active">
                </div>

                <!-- Categories Tab Content -->
                <div id="categoryContent" class="tab-content">
                </div>
                <!-- Categories Tab Content -->
                <div id="subcategoryContent" class="tab-content">
                </div>

                <!-- Attributes Tab Content -->
                <div id="attributeContent" class="tab-content">
                </div>

                <!-- Materials Tab Content -->
                <div id="materialContent" class="tab-content">
                </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            loadTab('polish');
            $(".tab-button").on("click", function () {
                $(".tab-button").removeClass("active border-blue-600 text-blue-600");
                $(this).addClass("active border-blue-600 text-blue-600");
                $(".tab-content").removeClass("active").hide();
                const tab = $(this).attr("id").replace("Tab", "");
                $("#" + tab + "Content").addClass("active").show();
                loadTab(tab);
            });

            function loadTab(tab) {
                let url = "";
                switch (tab) {
                    case "polish":
                        url = "/Inventory/LoadPolishList";
                        break;
                    case "category":
                        url = "/Inventory/LoadCategoryList";
                        break;
                    case "subcategory":
                        url = "/Inventory/LoadSubCategoryList";
                        break;
                    case "attribute":
                        url = "/Inventory/LoadAttributeList";
                        break;
                    case "material":
                        url = "/Inventory/LoadMaterialList";
                        break;
                }
                if (url !== "") {
                    $("#" + tab + "Content").html(`<div class='text-center py-10 text-gray-500'>Loading...</div>`);
                    $.get(url, function (data) {
                        $("#" + tab + "Content").html(data);
                    }).fail(function (xhr, status, error) {
                        console.error("Error loading tab:", error);
                    });
                }
            }
        });
        $(document).off("click", "#addPolishBtn").on("click", "#addPolishBtn", function () {
            const url = $(this).data("url");
            $.get(url, function (data) {
                $("#modalContainer").html(data);
                $("#addPolishModal").modal("show");
            });
        });

        $(document).off("click", "#addCategoryBtn").on("click", "#addCategoryBtn", function () {
            const url = $(this).data("url");
            $.get(url, function (data) {
                console.log(data);
                $("#modalContainer").html(data);
                $("#addCategoryModal").modal("show");
            });
        });
        $(document).off("click", "#addSubCategoryBtn").on("click", "#addSubCategoryBtn", function () {
            const url = $(this).data("url");
            $.get(url, function (data) {
                console.log(data);
                $("#modalContainer").html(data);
                $("#addSubCategoryModal").modal("show");
            });
        });


        $(document).off("submit", "#polishForm").on("submit", "#polishForm", function (e) {
            e.preventDefault();
            const formData = {
                Id: $("#polishId").val() || 0,
                PolishName: $("#polishName").val(),
                Description: $("#polishDescription").val(),
                IsActive: $("input[name='polishStatus']:checked").val()
            };

            $.ajax({
                url: "/Inventory/SavePolish",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(formData),
                success: function (response) {
                    if (response.success) {
                        toastr.success(response.message);
                        $("#addPolishModal").modal("hide");
                        console.log("Reloading Polish tab...");
                        loadTab('polish');

                    } else {
                        toastr.error(response.message || "An error occurred while saving the polish type.");
                    }
                },
                error: function (xhr) {
                    toastr.error("Failed to save polish type. Server responded with: " + xhr.statusText);
                }
            });
        });


        $(document).off("submit", "#categoryForm").on("submit", "#categoryForm", function (e) {
            e.preventDefault();
            const formData = {
                ProductHeadId: $("#categoryId").val() || 0,
                Name: $("#categoryName").val(),
                Description: $("#categoryDescription").val(),
                IsActive: $("input[name='categoryStatus']:checked").val() === "true"
            };
            $.ajax({
                url: "/Inventory/AddEditCategory",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(formData),
                success: function (response) {
                    if (response.success) {
                        toastr.success(response.message);
                        $("#addCategoryModal").modal("hide");
                        console.log("Reloading Polish tab...");
                        loadTab('category');

                    } else {
                        toastr.error(response.message || "An error occurred while saving the polish type.");
                    }
                },
                error: function (xhr) {
                    toastr.error("Failed to save polish type. Server responded with: " + xhr.statusText);
                }
            });
        });

        $(document).off("submit", "#subcategoryForm").on("submit", "#subcategoryForm", function (e) {
            e.preventDefault();
            const formData = {
                Id: $("#subcategoryId").val() || 0,
                Name: $("#subcategoryName").val(),
                Description: $("#subcategoryDescription").val(),
                ProductHeadId: $("#parentCategory").val() || null,
                IsActive: $("input[name='subcategoryStatus']:checked").val() === "true"

            };
            $.ajax({
                url: "/Inventory/AddEditSubCategory",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(formData),
                success: function (response) {
                    if (response.success) {
                        toastr.success(response.message);
                        $("#addSubCategoryModal").modal("hide");
                        console.log("Reloading Polish tab...");
                        loadTab('subcategory');

                    } else {
                        toastr.error(response.message || "An error occurred while saving the polish type.");
                    }
                },
                error: function (xhr) {
                    toastr.error("Failed to save polish type. Server responded with: " + xhr.statusText);
                }
            });
        });


    </script>

</body>

</html>